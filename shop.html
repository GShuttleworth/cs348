<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html lang="en">
<head>
  <script type="text/javascript" src="model.js"></script>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
  <title>eVeg - Shop</title>
  <script type="text/javascript">
    function addItemMessage(item, val, product) {
	if (val == 0) {
		Materialize.toast(item + " not added", 4000, 'red');
	} else {
		addToBasket(product, val);
		total = countItems();
		document.getElementById('main-count').innerHTML = total;
        	document.getElementById('mob-count').innerHTML = total;		
      		Materialize.toast(item + " added", 4000);
	}	
	return false;
    }
    function countItems() {
        var basket = readBasket();
        total = 0;
        for (var product in basket) {
                if (parseInt(basket[product]) > 0) {
                        total += 1;
                }
        }
        return total;
   }
  </script>

  <!-- CSS  -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
  <link href="css/style.css" type="text/css" rel="stylesheet" media="screen,projection"/>
</head>
<body>
<div class="navbar-fixed">
  <!-- Navigation -->
  <nav class="green" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" href="eveg.html" target="_blank" class="brand-logo">eVeg</a>
      <ul class="right hide-on-med-and-down">
        <li><a href="#" onclick="window.open('eveg.html');self.close()">Home</a></li>
        <li><a href="#" onclick="window.open('shop.html');self.close()" style="background-color: green;">Shop</a></li>
        <li><a href="#" onclick="window.open('basket.html');self.close()">Basket<span id="main-count" class="new badge green darken-4" data-badge-caption="items"></span></a></li>
      </ul>

      <!-- Mobile Nav -->
      <ul id="nav-mobile" class="side-nav">
	<li><a href="#" onclick="window.open('eveg.html');self.close()">Home</a></li>
        <li><a href="#" onclick="window.open('shop.html');self.close()" style="background-color: lightgrey;">Shop</a></li>
        <li><a href="#" onclick="window.open('basket.html');self.close()">Basket<span id="mob-count" class="new badge green darken-4" data-badge-caption="items"></span></a></li>
      </ul>
      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
  </nav>
</div>
  <!-- End Navigation -->

  <!-- Main Page Content -->
  <main>
    <div class="section no-pad-bot" id="index-banner">
      <div class="container">
        <h2 class="header">Shop</h1>
      </div>
    </div>

    <div class="container">
      <script>
        var productDetails = getProductDetails();
	var index = 0;
        for (var product in productDetails) {
	  if(index%3 == 0){
            document.write('<div class="row">');
          }
	  document.write('<div class="col s12 m4"><div class="card"><div class="card-image">');
	  // This is some ugly code!!
          document.write('<img src="img/' + productDetails[product]["image"] + '" /></div>');
          document.write('<div class="card-content"><span class="card-title">' + productDetails[product]["name"] + '</span>');
          // Split this up..
	  document.write('<p>' + productDetails[product]["description"] + '</p></br><p><b>Â£' + productDetails[product]["price"] + '</b> per ' + productDetails[product]["units"] + '</p></div>');
          document.write('<div class="card-action"><div style="max-width:200px;height:50px;margin: 0 auto">');
	  document.write('<form id="add-\'' + product + '\'" onsubmit="return addItemMessage(\'' + productDetails[product]["name"] + '\', document.getElementById(\'' + product + '\').value, \'' + product + '\')">');
	  document.write('<div class="input-field"><input name="' + product + '" id="' + product + '" type="number" min="0" default="0" style="float:left; display:inline; width: 40%;" required/><label for="' + product +'">Quantity</label></div>');
          document.write('<input style="float:right;display:inline;" class="btn green" name="add' + product + '" type="submit" value="Add"/></form></div></div></div></div>');
	  if(index%3 == 2){
            document.write('</div>');
          }
          index++;
        }
      </script>
     </div>
    </div>    
  </main>
  <!-- end Main Page Content -->

  <!-- Footer copyright -->
  <footer class="page-footer green darken-3">
    <div class="footer-copyright">
      <div class="container right-align">
        Copyright &copy; 2014 InterVeg Coventry Ltd.
      </div>
    </div>
  </footer>
  <!-- end Footer copyright -->

  <!--  Scripts-->
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script src="js/materialize.js"></script>
  <script src="js/init.js"></script>
  <script type="text/javascript">
    $( document ).ready(function() {
	var total = countItems();
        document.getElementById('main-count').innerHTML = total;
        document.getElementById('mob-count').innerHTML = total;
   });
  </script>
</body>
</html>
